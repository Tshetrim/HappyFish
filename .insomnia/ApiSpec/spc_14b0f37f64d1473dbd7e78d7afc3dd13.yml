_id: spc_14b0f37f64d1473dbd7e78d7afc3dd13
type: ApiSpec
parentId: wrk_e954046cbb064c628f2e3318fee48b95
modified: 1654985192428
created: 1654790193933
fileName: HappyFishDesign
contents: >+
  openapi: 3.0.0

  info:
    description: "This is the HappyFish server that communicates with the RaspberryPi. The server hosts the dashboard to allow customers to configure the hardware virtually. "
    version: 1.0.0
    title: HappyFish

   
  tags:
    - name: pwm
      description: Initial step to recognize hardware
    - name: racks
      description: Framework holding all the shelves
    - name: shelves
      description: Individual shelf controlling lights
    - name: api
      description: Endpoints to interact with shelves

  paths:
    /config/pwm:
      post:
        tags: 
          - pwm
        summary: Adds a new PWM module to the configuration
        responses:
          '201':
            description: Success
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/PwmModule"

    /config/pwm/name:
      put:
        tags:
          - pwm
        summary: Updates the name of PWM module
        requestBody:
          $ref: "#/components/requestBodies/NameUpdate"
        responses:
          '400': 
            description: Bad Request, wrong/missing parameters
          '201':
            description: Success, name updated
    "/config/pwm/{pwmId}":
      delete:
        tags:
          - pwm
        summary: Deletes the PWM module from configurations
        parameters:
          - name: pwmId
            in: path
            description: pwm ID to delete
            required: true
            schema:
              type: string
              example: 62a2133b54233ce1caebf364
        responses:
          '400': 
            description: Bad Request, wrong/missing parameters
          '200':
            description: Successfully deleted the module
    
    /config/rack:
      post:
        tags:
          - racks
        summary: Adds a new Rack to the project
        responses:
          '201': 
            description: Success
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Rack"
          '400':
            description: Unable to fullfill request
    /config/rack/name:
      put:
        tags:
          - racks
        summary: Updates the Racks name
        requestBody:
          $ref: "#/components/requestBodies/NameUpdate"
        responses:
          '400': 
            description: Bad Request, wrong/missing parameters
          '201':
            description: Success, name updated
    "/config/rack/{rackId}":
      delete:
        tags:
          - racks
        summary: Deletes the Rack from configurations
        parameters:
          - name: rackId
            in: path
            description: Rack ID to delete
            required: true
            schema:
              type: string
              example: 62a2133b54233ce1caebf364
        responses:
          '400': 
            description: Bad Request, wrong/missing parameters
          '200':
            description: Successfully deleted the Rack
    /config/shelf:
      post:
        tags:
          - shelves
        summary: Creates a new shelf in given rack
        parameters:
          - name: rackId
            in: query
            description: Rack ID to insert new shelf
            required: true
            schema:
              type: string
              example: 62a2133b54233ce1caebf364
        responses:
          '400': 
            description: Bad Request, wrong/missing parameters
          '201':
            description: Successfully created a new shelf
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Shelf"
    /config/shelf/name:
      put:
        tags:
          - shelves
        summary: Updates the name of the shelf
        requestBody:
          $ref: "#/components/requestBodies/NameUpdate"
        responses:
          '400': 
            description: Bad Request, wrong/missing parameters
          '201':
            description: Success, name updated
    /config/shelf/addr:
      put:
        tags:
          - shelves
        summary: Attaches shelf to pwm module
        requestBody:
          content:
            application/x-www-form-urlencoded:
              schema:
                type: object
                properties:
                  _id:
                    description: ID corresponding to the shelf
                    type: string
                  kind:
                    description: The type of shelf (white, rgb, or hybrid)
                    type: string
                  pwmIdW:
                    description: The ID of the pwm module for white led
                    type: string
                  pwmIdRGB:
                    description: The ID of the pwm module for rgb led
                    type: string
                  wAddr:
                    description: pin out address for white led
                    type: string
                  rAddr:
                    description: pin out address for red led
                    type: string
                  gAddr:
                    description: pin out address for green led
                    type: string
                  bAddr:
                    description: pin out address for blue led
                    type: string
                    
        responses:
          '400': 
            description: Bad Request, wrong/missing parameters
          '201':
            description: Success, pwm updated
    "/config/shelf/{shelfId}":
      delete:
        tags:
          - shelves
        summary: Deletes the shelf from rack
        parameters:
          - name: shelfId
            in: path
            description: Shelf ID to delete
            required: true
            schema:
              type: string
              example: 62a2133b54233ce1caebf364
        responses:
          '400': 
            description: Bad Request, wrong/missing parameters
          '200':
            description: Successfully deleted the shelf
    /api/configs:
      get:
        tags:
          - api
        summary: Get current configuration of the system
        responses:
          '200':
            description: Success
    /api/shelf/mode:
      put:
        tags:
          - api
        summary: Changes the mode of the shelf
        requestBody:
          content:
            application/x-www-form-urlencoded:
              schema:
                type: object
                properties:
                  _id:
                    description: ID corresponding to the shelf
                    type: string
                  mode:
                    description: The new mode for shelf
                    type: number
        responses:
          '400':
            description: Bad Request, wrong/missing parameters
          '201':
            description: Success
    /api/shelf/value:
      put:
        tags:
          - api
        summary: Changes the light value of the shelf
        requestBody:
          content:
            application/x-www-form-urlencoded:
              schema:
                type: object
                properties:
                  _id:
                    description: ID corresponding to the shelf
                    type: string
                  wValue:
                    description: The value for white shelf (if kind is white)
                    type: number
                  rValue:
                    description: The value for red signal (if kind is rgb)
                    type: number
                  gValue:
                    description: The value for green signal (if kind is rgb)
                    type: number
                  bValue:
                    description: The value for blue signal (if kind is rgb)
                    type: number
        responses:
          '400':
            description: Bad Request, wrong/missing parameters
          '201':
            description: Success
  components:
    requestBodies:
        ObjectId:
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ObjectId"
          description: The id of the component that needs to be modified
          required: true
        NameUpdate:
          content:
            application/x-www-form-urlencoded:
              schema:
                type: object
                properties:
                  _id:
                    description: ID corresponding to the Component
                    type: string
                  name:
                    description: The new name of the Component
                    type: string
        DeleteComponent:
          content:
            application/x-www-form-urlencoded:
              schema:
                type: object
                properties:
                  _id:
                    description: ID corresponding to the Component needed to be deleted
                    type: string
    schemas:
      ObjectId:
        type: string
      PwmModule:
        type: object
        properties:
          _id:
            $ref: "#/components/schemas/ObjectId"
          name:
            type: string
            example: sample pwm
          next:
            $ref: "#/components/schemas/ObjectId"
          prev:
            $ref: "#/components/schemas/ObjectId"
          addrs:
            type: object
            properties:
              a0:
                $ref: "#/components/schemas/ObjectId"
              a1:
                $ref: "#/components/schemas/ObjectId"
              a2:
                $ref: "#/components/schemas/ObjectId"
              a3:
                $ref: "#/components/schemas/ObjectId"
              a4:
                $ref: "#/components/schemas/ObjectId"
              a5:
                $ref: "#/components/schemas/ObjectId"
              a6:
                $ref: "#/components/schemas/ObjectId"
              a7:
                $ref: "#/components/schemas/ObjectId"
              a8:
                $ref: "#/components/schemas/ObjectId"
              a9:
                $ref: "#/components/schemas/ObjectId"
              a10:
                $ref: "#/components/schemas/ObjectId"
              a11:
                $ref: "#/components/schemas/ObjectId"
              a12:
                $ref: "#/components/schemas/ObjectId"
              a13:
                $ref: "#/components/schemas/ObjectId"
              a14:
                $ref: "#/components/schemas/ObjectId"
              a15:
                $ref: "#/components/schemas/ObjectId"
      Rack:
        type: object
        properties:
          _id:
            $ref: "#/components/schemas/ObjectId"
          name:
            type: string
            example: sample rack
          shelves:
            type: array
            items:
              $ref: "#/components/schemas/ObjectId"
      Shelf:
        type: object
        properties:
          _id:
            $ref: "#/components/schemas/ObjectId"
          name:
            type: string
          rackId:
            $ref: "#/components/schemas/ObjectId"
          pwmIdW:
            $ref: "#/components/schemas/ObjectId"
          pwmIdRGB:
            $ref: "#/components/schemas/ObjectId"
          kind:
            type: string
            description: describes what kind of shelf this is
            enum:
              - white
              - rgb
              - hybrid
          white: 
            type: object
            description: data fields pertaining to WhiteShelf
          rgb: 
            type: object
            description: data fields pertaining to RGBShelf
          hybrid: 
            type: object
            description: data fields pertaining to HybridShelf
            
      WhiteShelf:
        type: object
        properties:
          addr: 
            type: string
            example: a0
          override:
            type: boolean
          value: 
            type: integer
      RGBShelf:
        type: object
        properties:
          override:
            type: boolean
          rAddr: 
            type: string
            example: a0
          gAddr: 
            type: string
            example: a1
          bAddr: 
            type: string
            example: a2
          rValue: 
            type: integer
          gValue: 
            type: integer
          bValue: 
            type: integer
      HybridShelf:
        type: object
        properties:
          wAddr: 
            type: string
          wValue: 
            type: integer
          rAddr: 
            type: string
          rValue: 
            type: integer
          gAddr: 
            type: string
          gValue: 
            type: integer
          bAddr: 
            type: string
          bValue: 
            type: integer

contentType: yaml
